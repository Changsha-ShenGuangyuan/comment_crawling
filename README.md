# 评论爬取工具 (Comment Crawling Tool)

一个安全的应用商店评论爬取工具，支持从 Google Play Store 和 Apple App Store 批量下载和导出应用评论数据。

## 🔒 安全特性

### ✅ 完整的安全认证系统
- **密码保护**：访问需要管理员密码
- **会话管理**：24小时安全会话，自动过期
- **速率限制**：防止恶意请求和过度使用
- **输入验证**：防止XSS和注入攻击
- **安全日志**：记录所有重要操作

### 🛡️ 多层防护机制
- **通用速率限制**：15分钟内最多100次请求
- **登录限制**：15分钟内最多5次登录尝试
- **爬取限制**：每小时最多5次评论爬取
- **IP控制**：可配置IP白名单（可选）
- **文件安全**：只允许下载指定格式的文件

## 🚀 快速开始

### 1. 安装依赖
```bash
npm install
```

### 2. 配置环境变量
编辑 `.env` 文件，设置您的安全配置：

```env
# 管理员密码 - 请修改为您自己的强密码
ADMIN_PASSWORD=your_strong_password_here

# 服务端口
PORT=3000

# Session密钥 - 请修改为长随机字符串
SESSION_SECRET=your_very_long_and_random_session_secret

# IP访问控制（* 表示允许所有IP，或设置具体IP列表）
ALLOWED_IPS=*

# 速率限制配置
RATE_LIMIT_WINDOW_MS=900000      # 15分钟
RATE_LIMIT_MAX_REQUESTS=100      # 通用请求限制
CRAWL_LIMIT_WINDOW_MS=3600000    # 1小时
CRAWL_LIMIT_MAX_REQUESTS=5       # 爬取请求限制
```

### 3. 启动服务
```bash
npm start
```

### 4. 访问应用
1. 打开浏览器访问：`http://localhost:3000`
2. 输入管理员密码登录
3. 开始使用评论爬取功能

## 📱 支持平台

- **Android**：Google Play Store
- **iOS**：Apple App Store

## 🔧 主要功能

### 评论筛选
- ⭐ 按评分筛选（1-5星或全部）
- 🌍 按国家/地区筛选（200+个国家）
- 🗣️ 按语言筛选（多语言支持）

### 数据导出
- 📊 Excel格式(.xlsx)
- 📝 包含：用户名、日期、评分、评论内容
- 🎨 自动调整列宽，优化显示

### 用户体验
- 🖥️ 响应式Web界面
- 💾 记住上次选择的设置
- 📱 移动端友好
- ⚡ 实时进度提示

## 🔐 安全最佳实践

### 部署建议

1. **强密码设置**
   ```bash
   # 生成强密码示例
   ADMIN_PASSWORD=MyStr0ng!P@ssw0rd2024#CommentCrawler
   ```

2. **IP限制**（推荐生产环境使用）
   ```bash
   # 只允许特定IP访问
   ALLOWED_IPS=192.168.1.100,10.0.0.50
   ```

3. **HTTPS部署**
   - 使用反向代理（Nginx/Apache）
   - 配置SSL证书
   - 启用HSTS

4. **防火墙配置**
   - 只开放必要端口
   - 限制访问来源

### 监控和维护

- **安全日志**：所有操作都有详细日志记录
- **错误处理**：友好的错误提示和恢复机制
- **会话管理**：自动清理过期会话

## 📊 使用统计

系统会记录以下安全事件：
- 登录成功/失败
- 爬取请求
- 文件下载
- 异常访问尝试

## 🐛 故障排除

### 常见问题

1. **登录失败**
   - 检查 `.env` 文件中的 `ADMIN_PASSWORD`
   - 确认密码没有特殊字符转义问题

2. **速率限制触发**
   - 等待限制时间窗口结束
   - 检查是否有其他用户同时使用

3. **文件下载失败**
   - 检查服务器磁盘空间
   - 确认文件生成成功

### 日志查看
```bash
# 启动时会显示安全日志
[SECURITY] 2024-01-01T12:00:00.000Z - LOGIN_SUCCESS - IP: 192.168.1.100
[SECURITY] 2024-01-01T12:05:00.000Z - FETCH_REQUEST - IP: 192.168.1.100
```

## ⚠️ 重要提醒

1. **密码安全**：请立即修改默认密码
2. **合规使用**：遵守目标平台的使用条款
3. **数据保护**：下载的数据请妥善保管
4. **更新维护**：定期检查和更新依赖包

## 📄 许可证

ISC License

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目。

---

**⚡ 享受安全的评论爬取体验！** 